<div class="container my-5 pt-3">
  <div class="text-center mb-5">
    <h1 class="display-4 fw-bold text-primary">
      <i class="fas fa-bookmark me-2"></i> ブックマーク一覧
    </h1>
    <p class="lead text-muted">お気に入りの情報へ素早くアクセス</p>
  </div>

  <ul class="nav nav-tabs nav-justified mb-4" id="bookmarkTabs" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="places-tab" data-toggle="tab" href="#places" role="tab" aria-controls="places" aria-selected="true">
        <i class="fas fa-map-marker-alt me-1"></i> 場所
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="events-tab" data-toggle="tab" href="#events" role="tab" aria-controls="events" aria-selected="false">
        <i class="fas fa-calendar-alt me-1"></i> イベント
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="posts-tab" data-toggle="tab" href="#posts" role="tab" aria-controls="posts" aria-selected="false">
        <i class="fas fa-pencil-alt me-1"></i> 投稿
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="reviews-tab" data-toggle="tab" href="#reviews" role="tab" aria-controls="reviews" aria-selected="false">
        <i class="fas fa-star me-1"></i> レビュー
      </a>
    </li>
  </ul>

  <div class="tab-content" id="bookmarkTabsContent">
    
    <div class="tab-pane fade show active" id="places" role="tabpanel" aria-labelledby="places-tab">
      <% if @places.any? %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
          <% @places.each do |place| %>
            <div class="col mb-4">
              <div class="card shadow-lg h-100 bookmark-card-hover border-left border-primary border-w-3">
                <div class="card-body">
                  <h5 class="card-title fw-bold text-primary"><%= link_to place.name, place_path(place), class: "text-decoration-none text-primary" %></h5>
                  <p class="text-muted small"><%= truncate(place.description, length: 70) %></p>
                  <%= link_to "場所を見る", place_path(place), class: "btn btn-outline-primary btn-sm mt-2 rounded-pill" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="alert alert-info text-center" role="alert">
          <i class="fas fa-info-circle me-2"></i> ブックマークした場所はありません。
        </div>
      <% end %>
    </div>

    <div class="tab-pane fade" id="events" role="tabpanel" aria-labelledby="events-tab">
      <% if @events.any? %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
          <% @events.each do |event| %>
            <div class="col mb-4">
              <div class="card shadow-lg h-100 bookmark-card-hover border-left border-info border-w-3">
                <div class="card-body">
                  <h5 class="card-title fw-bold text-info"><%= link_to event.title, event_path(event), class: "text-decoration-none text-info" %></h5>
                  <p class="text-muted small"><%= truncate(event.body, length: 70) %></p>
                  <%= link_to "イベント詳細", event_path(event), class: "btn btn-outline-info btn-sm mt-2 rounded-pill" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="alert alert-info text-center" role="alert">
          <i class="fas fa-info-circle me-2"></i> ブックマークしたイベントはありません。
        </div>
      <% end %>
    </div>

    <div class="tab-pane fade" id="posts" role="tabpanel" aria-labelledby="posts-tab">
      <% if @posts.any? %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
          <% @posts.each do |post| %>
            <div class="col mb-4">
              <div class="card shadow-lg h-100 bookmark-card-hover border-left border-success border-w-3">
                <div class="card-body">
                  <h5 class="card-title fw-bold text-success"><%= link_to post.title, post_path(post), class: "text-decoration-none text-success" %></h5>
                  <p class="text-muted small"><%= truncate(post.body, length: 70) %></p>
                  <%= link_to "投稿を見る", post_path(post), class: "btn btn-outline-success btn-sm mt-2 rounded-pill" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="alert alert-info text-center" role="alert">
          <i class="fas fa-info-circle me-2"></i> ブックマークした投稿はありません。
        </div>
      <% end %>
    </div>

    <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
      <% if @reviews.any? %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
          <% @reviews.each do |review| %>
            <div class="col mb-4">
              <div class="card shadow-lg h-100 bookmark-card-hover border-left border-warning border-w-3">
                <div class="card-body">
                  <div class="mb-2 text-warning fw-bold review-star-medium">
                    <%= render 'public/reviews/display', review: review %>
                  </div>
                  <p class="text-muted small mt-2"><%= truncate(review.body, length: 70) %></p>
                  <%= link_to "レビュー詳細", post_review_path(review.post, review), class: "btn btn-outline-warning btn-sm mt-2 rounded-pill" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="alert alert-info text-center" role="alert">
          <i class="fas fa-info-circle me-2"></i> ブックマークしたレビューはありません。
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  $(function () {
    // ページロード時にURLのハッシュをチェックして、対応するタブを開く
    var hash = window.location.hash;
    if (hash) {
      $('.nav-tabs a[href="' + hash + '"]').tab('show');
    }
    
    // タブが切り替わったときにURLハッシュを更新
    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
      window.location.hash = e.target.hash;
    });
  });
</script>